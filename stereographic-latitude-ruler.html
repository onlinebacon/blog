<body style="background-color:#111;">
	<canvas></canvas>
</body>
<script>

const width = 600;
const height = Math.round(width*Math.SQRT2);
const canvas = document.querySelector('canvas');
canvas.width = width;
canvas.height = height;
const val = (px) => width/600*px;
const ctx = canvas.getContext('2d');
const margin = val(20.5);
const clear = () => {
	ctx.fillStyle = '#222';
	ctx.fillRect(0, 0, width, height);
};
const sin = deg => Math.sin(deg/180*Math.PI);
const cos = deg => Math.cos(deg/180*Math.PI);
const fn = (lat) => cos(lat)/(1 + sin(lat));
const line = (ax, ay, bx, by) => {
	ctx.beginPath();
	ctx.moveTo(ax, ay);
	ctx.lineTo(bx, by);
	ctx.stroke();
};
const nextSkip = {
	0: 5,
	5: 10,
	10: 10,
};
const drawRuler = (sx, sy, minLat, size) => {
	ctx.lineWidth = val(1);
	const longLine = val(10);
	const shortLine = val(5);
	const textGap = val(5);
	const minDist = val(10);
	const c = size/fn(minLat);
	const top = sy;
	const bottom = top + size;
	const left = sx;
	line(left, top, left, bottom);
	const calcY = (lat) => top + fn(lat)*c;
	const addMark = (lat, length, label) => {
		const y = calcY(lat);
		const x = left + length;
		line(left, y, x, y);
		if (label) {
			ctx.fillText(Math.abs(lat), x + textGap, y);
		}
	};
	addMark(90, longLine, true);
	let lastLat = 90;
	let lastY = calcY(90);
	let skipping = 0;
	for (let lat=89; lat>=minLat; lat--) {
		const y = calcY(lat);
		if (skipping && lat % skipping !== 0) {
			continue;
		}
		if (y - lastY < minDist) {
			skipping = nextSkip[skipping];
			continue;
		}
		addMark(lat, longLine, true);
		skipping = 0;
		lastLat = lat;
		lastY = y;
	}
};
clear();
ctx.strokeStyle = '#ccc';
ctx.fillStyle = '#ccc';
ctx.textBaseline = 'middle';
ctx.textAlign = 'left';
ctx.font = val(10) + 'px arial';
drawRuler(margin, margin, -60, height - margin*2);
</script>
